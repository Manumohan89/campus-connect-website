const ExcelJS = require('exceljs');
const pool = require('../db');

function cleanData(value) {
  if (value === null || value === undefined) {
    return 0;
  }
  const cleanedValue = parseInt(value.toString().replace(/[^0-9]/g, ''), 10);
  return isNaN(cleanedValue) ? 0 : cleanedValue;
}

function convertToGradePoints(totalMarks) {
  if (totalMarks >= 90) return 10;
  if (totalMarks >= 80) return 9;
  if (totalMarks >= 70) return 8;
  if (totalMarks >= 60) return 7;
  if (totalMarks >= 50) return 6;
  if (totalMarks >= 40) return 5;
  return 0;
}

function getCreditsForSubject(subjectCode) {
  const creditsMap = {
    // 2021 Scheme: Semester I (Physics and Chemistry Cycles)
    '21MAT11': 3,
    '21PHY12': 3,
    '21ELE13': 3,
    '21CIV14': 3,
    '21EVN15': 3,
    '21PHYL16': 1,
    '21ELEL17': 1,
    '21EGH18': 2,
    '21IDT19': 1,
    '21SFH19': 1,
    '21CHE12': 3,
    '21PSP13': 3,
    '21ELN14': 3,
    '21EME15': 3,
    '21CHEL16': 1,
    '21CPL17': 1,

    // 2021 Scheme: Semester II (Physics and Chemistry Cycles)
    '21MAT21': 3,
    '21PHY22': 3,
    '21ELE23': 3,
    '21CIV24': 3,
    '21EGDL25': 3,
    '21PHYL26': 1,
    '21ELEL27': 1,
    '21EGH28': 2,
    '21IDT29': 1,
    '21SFH29': 1,
    '21CHE22': 3,
    '21PSP23': 3,
    '21ELN24': 3,
    '21EME25': 3,
    '21CHEL26': 1,
    '21CPL27': 1,

    // 2021 Scheme: Semester III
    '21MAT31': 3,
    '21CS32': 4,
    '21CS33': 4,
    '21CS34': 3,
    '21CSL35': 1,
    '21UH36': 1,
    '21KSK37': 1,
    '21KBK37': 1,
    '21CIP37': 1,
    '21CSL381': 1,
    '21CS382': 1,
    '21CS383': 1,
    '21CS384': 1,
    '21MATDIP31': 0,
    '21AI31': 4,
    '21AI32': 4,
    '21AI33': 3,
    '21AI34': 3,
    '21AIL35': 1,
    '21AIL381': 1,
    '21AIL382': 1,
    '21AIL383': 1,
    '21AIL384': 1,
    '21IS32': 4,
    '21IS33': 4,
    '21IS34': 3,
    '21ISL35': 1,
    '21ISL381': 1,
    '21ISL382': 1,
    '21ISL383': 1,
    '21ISL384': 1,
    '21AD32': 4,
    '21AD33': 4,
    '21AD34': 3,
    '21ADL35': 1,
    '21ADL381': 1,
    '21ADL382': 1,
    '21ADL383': 1,
    '21ADL384': 1,
    '21EC32': 4,
    '21EC33': 4,
    '21EC34': 3,
    '21ECL35': 1,
    '21ECL381': 1,
    '21ECL382': 1,
    '21ECL383': 1,
    '21ECL384': 1,
    '21ME32': 4,
    '21ME33': 4,
    '21ME34': 3,
    '21MEL35': 1,
    '21MEL381': 1,
    '21MEL382': 1,
    '21MEL383': 1,
    '21MEL384': 1,
    '21CV32': 4,
    '21CV33': 4,
    '21CV34': 3,
    '21CVL35': 1,
    '21CVL381': 1,
    '21CVL382': 1,
    '21CVL383': 1,
    '21CVL384': 1,

    // 2021 Scheme: Semester IV
    '21MAT41': 3,
    '21MATCS41': 3,
    '21CS41': 3,
    '21CS42': 4,
    '21CS43': 4,
    '21CS44': 3,
    '21BE45': 2,
    '21CSL46': 1,
    '21KSK47': 1,
    '21KBK47': 1,
    '21CIP47': 1,
    '21CSL481': 1,
    '21CS482': 1,
    '21CSL483': 1,
    '21CS484': 1,
    '21UH49': 1,
    '21INT49': 2,
    '21MATDIP41': 0,
    '21AI41': 4,
    '21AI42': 4,
    '21AI43': 3,
    '21AIL44': 1,
    '21AIL481': 1,
    '21AIL482': 1,
    '21AIL483': 1,
    '21AIL484': 1,
    '21IS41': 4,
    '21IS42': 4,
    '21IS43': 3,
    '21ISL44': 1,
    '21ISL481': 1,
    '21ISL482': 1,
    '21ISL483': 1,
    '21ISL484': 1,
    '21AD41': 4,
    '21AD42': 4,
    '21AD43': 3,
    '21ADL44': 1,
    '21ADL481': 1,
    '21ADL482': 1,
    '21ADL483': 1,
    '21ADL484': 1,
    '21EC41': 3,
    '21EC42': 4,
    '21EC43': 4,
    '21ECL44': 1,
    '21ECL481': 1,
    '21ECL482': 1,
    '21ECL483': 1,
    '21ECL484': 1,
    '21ME41': 4,
    '21ME42': 4,
    '21ME43': 3,
    '21MEL44': 1,
    '21MEL481': 1,
    '21MEL482': 1,
    '21MEL483': 1,
    '21MEL484': 1,
    '21CV41': 4,
    '21CV42': 4,
    '21CV43': 3,
    '21CVL44': 1,
    '21CVL481': 1,
    '21CVL482': 1,
    '21CVL483': 1,
    '21CVL484': 1,

    // 2021 Scheme: Semester V
    '21CS51': 3,
    '21CS52': 4,
    '21CS53': 3,
    '21CS54': 3,
    '21CSL55': 1,
    '21RMI56': 2,
    '21CIV57': 1,
    '21CSL581': 1,
    '21CSL582': 1,
    '21CSL583': 1,
    '21CSL584': 1,
    '21AI51': 3,
    '21AI52': 4,
    '21AI53': 3,
    '21AI54': 3,
    '21AIL55': 1,
    '21AIL581': 1,
    '21AIL582': 1,
    '21AIL583': 1,
    '21AIL584': 1,
    '21IS51': 3,
    '21IS52': 4,
    '21IS53': 3,
    '21IS54': 3,
    '21ISL55': 1,
    '21ISL581': 1,
    '21ISL582': 1,
    '21ISL583': 1,
    '21ISL584': 1,
    '21AD51': 3,
    '21AD52': 4,
    '21AD53': 3,
    '21AD54': 3,
    '21ADL55': 1,
    '21ADL581': 1,
    '21ADL582': 1,
    '21ADL583': 1,
    '21ADL584': 1,
    '21EC51': 3,
    '21EC52': 4,
    '21EC53': 3,
    '21EC54': 3,
    '21ECL55': 1,
    '21ECL581': 1,
    '21ECL582': 1,
    '21ECL583': 1,
    '21ECL584': 1,
    '21ME51': 3,
    '21ME52': 4,
    '21ME53': 3,
    '21ME54': 3,
    '21MEL55': 1,
    '21MEL581': 1,
    '21MEL582': 1,
    '21MEL583': 1,
    '21MEL584': 1,
    '21CV51': 3,
    '21CV52': 4,
    '21CV53': 3,
    '21CV54': 3,
    '21CVL55': 1,
    '21CVL581': 1,
    '21CVL582': 1,
    '21CVL583': 1,
    '21CVL584': 1,

    // 2021 Scheme: Semester VI
    '21CS61': 3,
    '21CS62': 4,
    '21CS63': 3,
    '21CS641': 3,
    '21CS642': 3,
    '21CS643': 3,
    '21CS644': 3,
    '21CS651': 3,
    '21CS652': 3,
    '21CS653': 3,
    '21CS654': 3,
    '21CS655': 3,
    '21CS656': 3,
    '21CSL66': 1,
    '21CSMP67': 2,
    '21INT68': 3,
    '21AI61': 3,
    '21AI62': 4,
    '21AI63': 3,
    '21AI641': 3,
    '21AI642': 3,
    '21AI643': 3,
    '21AI644': 3,
    '21AI651': 3,
    '21AI652': 3,
    '21AI653': 3,
    '21AI654': 3,
    '21AIL66': 1,
    '21AIMP67': 2,
    '21IS61': 3,
    '21IS62': 4,
    '21IS63': 3,
    '21IS641': 3,
    '21IS642': 3,
    '21IS643': 3,
    '21IS644': 3,
    '21IS651': 3,
    '21IS652': 3,
    '21IS653': 3,
    '21IS654': 3,
    '21ISL66': 1,
    '21ISMP67': 2,
    '21AD61': 3,
    '21AD62': 4,
    '21AD63': 3,
    '21AD641': 3,
    '21AD642': 3,
    '21AD643': 3,
    '21AD644': 3,
    '21AD651': 3,
    '21AD652': 3,
    '21AD653': 3,
    '21AD654': 3,
    '21ADL66': 1,
    '21ADMP67': 2,
    '21EC61': 3,
    '21EC62': 4,
    '21EC63': 3,
    '21EC641': 3,
    '21EC642': 3,
    '21EC643': 3,
    '21EC644': 3,
    '21EC651': 3,
    '21EC652': 3,
    '21EC653': 3,
    '21EC654': 3,
    '21ECL66': 1,
    '21ECMP67': 2,
    '21ME61': 3,
    '21ME62': 4,
    '21ME63': 3,
    '21ME641': 3,
    '21ME642': 3,
    '21ME643': 3,
    '21ME644': 3,
    '21ME651': 3,
    '21ME652': 3,
    '21ME653': 3,
    '21ME654': 3,
    '21MEL66': 1,
    '21MEMP67': 2,
    '21CV61': 3,
    '21CV62': 4,
    '21CV63': 3,
    '21CV641': 3,
    '21CV642': 3,
    '21CV643': 3,
    '21CV644': 3,
    '21CV651': 3,
    '21CV652': 3,
    '21CV653': 3,
    '21CV654': 3,
    '21CVL66': 1,
    '21CVMP67': 2,

    // 2021 Scheme: Semester VII
    '21CS71': 3,
    '21CS72': 2,
    '21CS731': 3,
    '21CS732': 3,
    '21CS733': 3,
    '21CS734': 3,
    '21CS735': 3,
    '21CS741': 3,
    '21CS742': 3,
    '21CS743': 3,
    '21CS744': 3,
    '21CS745': 3,
    '21CS751': 3,
    '21CS752': 3,
    '21CS753': 3,
    '21CS754': 3,
    '21CS755': 3,
    '21CSP76': 10,
    '21AI71': 3,
    '21AI72': 2,
    '21AI731': 3,
    '21AI732': 3,
    '21AI733': 3,
    '21AI734': 3,
    '21AI735': 3,
    '21AI741': 3,
    '21AI742': 3,
    '21AI743': 3,
    '21AI744': 3,
    '21AI745': 3,
    '21AI751': 3,
    '21AI752': 3,
    '21AI753': 3,
    '21AI754': 3,
    '21AIP76': 10,
    '21IS71': 3,
    '21IS72': 2,
    '21IS731': 3,
    '21IS732': 3,
    '21IS733': 3,
    '21IS734': 3,
    '21IS735': 3,
    '21IS741': 3,
    '21IS742': 3,
    '21IS743': 3,
    '21IS744': 3,
    '21IS745': 3,
    '21IS751': 3,
    '21IS752': 3,
    '21IS753': 3,
    '21IS754': 3,
    '21ISP76': 10,
    '21AD71': 3,
    '21AD72': 2,
    '21AD731': 3,
    '21AD732': 3,
    '21AD733': 3,
    '21AD734': 3,
    '21AD735': 3,
    '21AD741': 3,
    '21AD742': 3,
    '21AD743': 3,
    '21AD744': 3,
    '21AD745': 3,
    '21AD751': 3,
    '21AD752': 3,
    '21AD753': 3,
    '21AD754': 3,
    '21ADP76': 10,
    '21EC71': 3,
    '21EC72': 2,
    '21EC731': 3,
    '21EC732': 3,
    '21EC733': 3,
    '21EC734': 3,
    '21EC735': 3,
    '21EC741': 3,
    '21EC742': 3,
    '21EC743': 3,
    '21EC744': 3,
    '21EC745': 3,
    '21EC751': 3,
    '21EC752': 3,
    '21EC753': 3,
    '21EC754': 3,
    '21ECP76': 10,
    '21ME71': 3,
    '21ME72': 2,
    '21ME731': 3,
    '21ME732': 3,
    '21ME733': 3,
    '21ME734': 3,
    '21ME735': 3,
    '21ME741': 3,
    '21ME742': 3,
    '21ME743': 3,
    '21ME744': 3,
    '21ME745': 3,
    '21ME751': 3,
    '21ME752': 3,
    '21ME753': 3,
    '21ME754': 3,
    '21MEP76': 10,
    '21CV71': 3,
    '21CV72': 2,
    '21CV731': 3,
    '21CV732': 3,
    '21CV733': 3,
    '21CV734': 3,
    '21CV735': 3,
    '21CV741': 3,
    '21CV742': 3,
    '21CV743': 3,
    '21CV744': 3,
    '21CV745': 3,
    '21CV751': 3,
    '21CV752': 3,
    '21CV753': 3,
    '21CV754': 3,
    '21CVP76': 10,

    // 2021 Scheme: Semester VIII
    '21CS81': 1,
    '21INT82': 15,
    '21INT822': 15,
    '21NS83': 0,
    '21PE83': 0,
    '21YO83': 0,
    '21AI81': 1,
    '21IS81': 1,
    '21AD81': 1,
    '21EC81': 1,
    '21ME81': 1,
    '21CV81': 1,

    // 2021 Scheme: Additional Codes
    '21SCR36': 1,
    '21XX56': 2,
    '21CS66X': 1,
    '21CS665': 2,
    '21CS655': 3,
    '21CS656': 3,
    '21CS661': 3,
    '21CS662': 3,
    '21CSL74': 1,
    '21CS76X': 2,
    '21CS821': 3,
    '21CS822': 3,
    '21CS831': 3,
    '21CS82': 8,
    '21CS83': 3,
    // Semester VII: Includes two PCCs (4 credits each), one mandatory course (3 credits), two PECs (3 credits each), and internship (15 credits) for all branches.
        '21CV71': 4, '21CV72': 4, '21CV73': 3, '21CV74A': 3, '21CV74B': 3, '21CV74C': 3, '21CV74D': 3,
        '21CV75A': 3, '21CV75B': 3, '21CV75C': 3, '21CV75D': 3, '21INT82': 15,
        '21CS71': 4, '21CS72': 4, '21CS73': 3, '21CS74A': 3, '21CS74B': 3, '21CS74C': 3, '21CS74D': 3,
        '21CS75A': 3, '21CS75B': 3, '21CS75C': 3, '21CS75D': 3, '21INT82': 15,
        '21AI71': 4, '21AI72': 4, '21AI73': 3, '21AI74A': 3, '21AI74B': 3, '21AI74C': 3, '21AI74D': 3,
        '21AI75A': 3, '21AI75B': 3, '21AI75C': 3, '21AI75D': 3, '21INT82': 15,
        '21IS71': 4, '21IS72': 4, '21IS73': 3, '21IS74A': 3, '21IS74B': 3, '21IS74C': 3, '21IS74D': 3,
        '21IS75A': 3, '21IS75B': 3, '21IS75C': 3, '21IS75D': 3, '21INT82': 15,
        '21EC71': 4, '21EC72': 4, '21EC73': 3, '21EC74A': 3, '21EC74B': 3, '21EC74C': 3, '21EC74D': 3,
        '21EC75A': 3, '21EC75B': 3, '21EC75C': 3, '21EC75D': 3, '21INT82': 15,
        '21ME71': 4, '21ME72': 4, '21ME73': 3, '21ME74A': 3, '21ME74B': 3, '21ME74C': 3, '21ME74D': 3,
        '21ME75A': 3, '21ME75B': 3, '21ME75C': 3, '21ME75D': 3, '21INT82': 15,
        '21EE71': 4, '21EE72': 4, '21EE73': 3, '21EE74A': 3, '21EE74B': 3, '21EE74C': 3, '21EE74D': 3,
        '21EE75A': 3, '21EE75B': 3, '21EE75C': 3, '21EE75D': 3, '21INT82': 15,
        '21TE71': 4, '21TE72': 4, '21TE73': 3, '21TE74A': 3, '21TE74B': 3, '21TE74C': 3, '21TE74D': 3,
        '21TE75A': 3, '21TE75B': 3, '21TE75C': 3, '21TE75D': 3, '21INT82': 15,
        '21AE71': 4, '21AE72': 4, '21AE73': 3, '21AE74A': 3, '21AE74B': 3, '21AE74C': 3, '21AE74D': 3,
        '21AE75A': 3, '21AE75B': 3, '21AE75C': 3, '21AE75D': 3, '21INT82': 15,
        '21BT71': 4, '21BT72': 4, '21BT73': 3, '21BT74A': 3, '21BT74B': 3, '21BT74C': 3, '21BT74D': 3,
        '21BT75A': 3, '21BT75B': 3, '21BT75C': 3, '21BT75D': 3, '21INT82': 15,
        '21CH71': 4, '21CH72': 4, '21CH73': 3, '21CH74A': 3, '21CH74B': 3, '21CH74C': 3, '21CH74D': 3,
        '21CH75A': 3, '21CH75B': 3, '21CH75C': 3, '21CH75D': 3, '21INT82': 15,
        '21IM71': 4, '21IM72': 4, '21IM73': 3, '21IM74A': 3, '21IM74B': 3, '21IM74C': 3, '21IM74D': 3,
        '21IM75A': 3, '21IM75B': 3, '21IM75C': 3, '21IM75D': 3, '21INT82': 15,
        '21CC71': 4, '21CC72': 4, '21CC73': 3, '21CC74A': 3, '21CC74B': 3, '21CC74C': 3, '21CC74D': 3,
        '21CC75A': 3, '21CC75B': 3, '21CC75C': 3, '21CC75D': 3, '21INT82': 15,
        '21CT71': 4, '21CT72': 4, '21CT73': 3, '21CT74A': 3, '21CT74B': 3, '21CT74C': 3, '21CT74D': 3,
        '21CT75A': 3, '21CT75B': 3, '21CT75C': 3, '21CT75D': 3, '21INT82': 15,
        '21AU71': 4, '21AU72': 4, '21AU73': 3, '21AU74A': 3, '21AU74B': 3, '21AU74C': 3, '21AU74D': 3,
        '21AU75A': 3, '21AU75B': 3, '21AU75C': 3, '21AU75D': 3, '21INT82': 15,
        '21BM71': 4, '21BM72': 4, '21BM73': 3, '21BM74A': 3, '21BM74B': 3, '21BM74C': 3, '21BM74D': 3,
        '21BM75A': 3, '21BM75B': 3, '21BM75C': 3, '21BM75D': 3, '21INT82': 15,
        '21EV71': 4, '21EV72': 4, '21EV73': 3, '21EV74A': 3, '21EV74B': 3, '21EV74C': 3, '21EV74D': 3,
        '21EV75A': 3, '21EV75B': 3, '21EV75C': 3, '21EV75D': 3, '21INT82': 15,
        '21IP71': 4, '21IP72': 4, '21IP73': 3, '21IP74A': 3, '21IP74B': 3, '21IP74C': 3, '21IP74D': 3,
        '21IP75A': 3, '21IP75B': 3, '21IP75C': 3, '21IP75D': 3, '21INT82': 15,
        '21IT71': 4, '21IT72': 4, '21IT73': 3, '21IT74A': 3, '21IT74B': 3, '21IT74C': 3, '21IT74D': 3,
        '21IT75A': 3, '21IT75B': 3, '21IT75C': 3, '21IT75D': 3, '21INT82': 15,
        '21MS71': 4, '21MS72': 4, '21MS73': 3, '21MS74A': 3, '21MS74B': 3, '21MS74C': 3, '21MS74D': 3,
        '21MS75A': 3, '21MS75B': 3, '21MS75C': 3, '21MS75D': 3, '21INT82': 15,
        '21MR71': 4, '21MR72': 4, '21MR73': 3, '21MR74A': 3, '21MR74B': 3, '21MR74C': 3, '21MR74D': 3,
        '21MR75A': 3, '21MR75B': 3, '21MR75C': 3, '21MR75D': 3, '21INT82': 15,
        '21MT71': 4, '21MT72': 4, '21MT73': 3, '21MT74A': 3, '21MT74B': 3, '21MT74C': 3, '21MT74D': 3,
        '21MT75A': 3, '21MT75B': 3, '21MT75C': 3, '21MT75D': 3, '21INT82': 15,
        '21ML71': 4, '21ML72': 4, '21ML73': 3, '21ML74A': 3, '21ML74B': 3, '21ML74C': 3, '21ML74D': 3,
        '21ML75A': 3, '21ML75B': 3, '21ML75C': 3, '21ML75D': 3, '21INT82': 15,
        '21MN71': 4, '21MN72': 4, '21MN73': 3, '21MN74A': 3, '21MN74B': 3, '21MN74C': 3, '21MN74D': 3,
        '21MN75A': 3, '21MN75B': 3, '21MN75C': 3, '21MN75D': 3, '21INT82': 15,
        '21NT71': 4, '21NT72': 4, '21NT73': 3, '21NT74A': 3, '21NT74B': 3, '21NT74C': 3, '21NT74D': 3,
        '21NT75A': 3, '21NT75B': 3, '21NT75C': 3, '21NT75D': 3, '21INT82': 15,
        '21PC71': 4, '21PC72': 4, '21PC73': 3, '21PC74A': 3, '21PC74B': 3, '21PC74C': 3, '21PC74D': 3,
        '21PC75A': 3, '21PC75B': 3, '21PC75C': 3, '21PC75D': 3, '21INT82': 15,
        '21ST71': 4, '21ST72': 4, '21ST73': 3, '21ST74A': 3, '21ST74B': 3, '21ST74C': 3, '21ST74D': 3,
        '21ST75A': 3, '21ST75B': 3, '21ST75C': 3, '21ST75D': 3, '21INT82': 15,
        '21TX71': 4, '21TX72': 4, '21TX73': 3, '21TX74A': 3, '21TX74B': 3, '21TX74C': 3, '21TX74D': 3,
        '21TX75A': 3, '21TX75B': 3, '21TX75C': 3, '21TX75D': 3, '21TX82': 15,

        // Semester VIII: Includes one PEC (3 credits), one OEC (3 credits), and major project (12 credits) for all branches.
        '21CV81': 3, '21CV82': 3, '21CV83': 3, '21CV84': 12,
        '21CS81': 3, '21CS82': 3, '21CS83': 3, '21CS84': 12,
        '21AI81': 3, '21AI82': 3, '21AI83': 3, '21AI84': 12,
        '21IS81': 3, '21IS82': 3, '21IS83': 3, '21IS84': 12,
        '21EC81': 3, '21EC82': 3, '21EC83': 3, '21EC84': 12,
        '21ME81': 3, '21ME82': 3, '21ME83': 3, '21ME84': 12,
        '21EE81': 3, '21EE82': 3, '21EE83': 3, '21EE84': 12,
        '21TE81': 3, '21TE82': 3, '21TE83': 3, '21TE84': 12,
        '21AE81': 3, '21AE82': 3, '21AE83': 3, '21AE84': 12,
        '21BT81': 3, '21BT82': 3, '21BT83': 3, '21BT84': 12,
        '21CH81': 3, '21CH82': 3, '21CH83': 3, '21CH84': 12,
        '21IM81': 3, '21IM82': 3, '21IM83': 3, '21IM84': 12,
        '21CC81': 3, '21CC82': 3, '21CC83': 3, '21CC84': 12,
        '21CT81': 3, '21CT82': 3, '21CT83': 3, '21CT84': 12,
        '21AU81': 3, '21AU82': 3, '21AU83': 3, '21AU84': 12,
        '21BM81': 3, '21BM82': 3, '21BM83': 3, '21BM84': 12,
        '21EV81': 3, '21EV82': 3, '21EV83': 3, '21EV84': 12,
        '21IP81': 3, '21IP82': 3, '21IP83': 3, '21IP84': 12,
        '21IT81': 3, '21IT82': 3, '21IT83': 3, '21IT84': 12,
        '21MS81': 3, '21MS82': 3, '21MS83': 3, '21MS84': 12,
        '21MR81': 3, '21MR82': 3, '21MR83': 3, '21MR84': 12,
        '21MT81': 3, '21MT82': 3, '21MT83': 3, '21MT84': 12,
        '21ML81': 3, '21ML82': 3, '21ML83': 3, '21ML84': 12,
        '21MN81': 3, '21MN82': 3, '21MN83': 3, '21MN84': 12,
        '21NT81': 3, '21NT82': 3, '21NT83': 3, '21NT84': 12,
        '21PC81': 3, '21PC82': 3, '21PC83': 3, '21PC84': 12,
        '21ST81': 3, '21ST82': 3, '21ST83': 3, '21ST84': 12,
        '21TX81': 3, '21TX82': 3, '21TX83': 3, '21TX84': 12,

    // Semester I
        'BMATS101': 4, 'BPHYS102': 4, 'BPOPS103': 3, 'BPCKS103': 3, 'BCEDK103': 3,
        'BESCK104A': 3, 'BESCK104B': 3, 'BESCK104C': 3, 'BESCK104D': 3, 'BESCK104E': 3,
        'BETCK105A': 3, 'BETCK105B': 3, 'BETCK105C': 3, 'BETCK105D': 3, 'BETCK105E': 3,
        'BETCK105F': 3, 'BETCK105G': 3, 'BETCK105H': 3, 'BETCK105I': 3, 'BETCK105J': 3,
        'BPLCK105A': 3, 'BPLCK105B': 3, 'BPLCK105C': 3, 'BPLCK105D': 3,
        'BENGK106': 1, 'BICOK107': 1, 'BPWSK106': 1, 'BKSKK107': 1, 'BKBKK107': 1,
        'BIDTK158': 1, 'BSFK108': 1, 'BSFHK158': 1, 'BPHYL152': 1, 'BCHEL153': 1,
        'BPSCK154': 1, 'BPCKL154': 1, 'BMATC11': 4, 'BMATE11': 4, 'BMATM11': 4, 'BMATS11': 4,

        // Semester II
        'BMATS201': 4, 'BCHES202': 4, 'BPOPS203': 3, 'BPCKS203': 3, 'BCEDK203': 3,
        'BESCK204A': 3, 'BESCK204B': 3, 'BESCK204C': 3, 'BESCK204D': 3, 'BESCK204E': 3,
        'BETCK205A': 3, 'BETCK205B': 3, 'BETCK205C': 3, 'BETCK205D': 3, 'BETCK205E': 3,
        'BETCK205F': 3, 'BETCK205G': 3, 'BETCK205H': 3, 'BETCK205I': 3, 'BETCK205J': 3,
        'BPLCK205A': 3, 'BPLCK205B': 3, 'BPLCK205C': 3, 'BPLCK205D': 3,
        'BENGK206': 1, 'BINSK207': 1, 'BPWSK206': 1, 'BKSKK207': 1, 'BKBKK207': 1,
        'BIDTK258': 1, 'BSFK208': 1, 'BSFHK258': 1, 'BCHEL252': 1, 'BPHYL253': 1,
        'BPSCK254': 1, 'BPCKL254': 1,

        // Semester III
        'BCV301': 4, 'BCV302': 4, 'BCV303': 4, 'BCV304': 3, 'BCVL305': 1, 'BCVL306': 1,
        'BCV306A': 3, 'BCV306B': 3, 'BCV306C': 3, 'BCV306D': 3,
        'BCV358A': 1, 'BCV358B': 1, 'BCV358C': 1, 'BCV358D': 1,
        'BCS301': 4, 'BCS302': 4, 'BCS303': 4, 'BCS304': 3, 'BCSL305': 1, 'BCSL306': 1,
        'BCS306A': 3, 'BCS306B': 3, 'BCS306C': 3, 'BCS306D': 3,
        'BCS358A': 1, 'BCS358B': 1, 'BCS358C': 1, 'BCS358D': 1,
        'BAI301': 4, 'BAI302': 4, 'BAI303': 4, 'BAI304': 3, 'BAIL305': 1, 'BAIL306': 1,
        'BAI306A': 3, 'BAI306B': 3, 'BAI306C': 3, 'BAI306D': 3,
        'BAI358A': 1, 'BAI358B': 1, 'BAI358C': 1, 'BAI358D': 1,
        'BIS301': 4, 'BIS302': 4, 'BIS303': 4, 'BIS304': 3, 'BISL305': 1, 'BISL306': 1,
        'BIS306A': 3, 'BIS306B': 3, 'BIS306C': 3, 'BIS306D': 3,
        'BIS358A': 1, 'BIS358B': 1, 'BIS358C': 1, 'BIS358D': 1,
        'BEC301': 4, 'BEC302': 4, 'BEC303': 4, 'BEC304': 3, 'BECL305': 1, 'BECL306': 1,
        'BEC306A': 3, 'BEC306B': 3, 'BEC306C': 3, 'BEC306D': 3,
        'BEC358A': 1, 'BEC358B': 1, 'BEC358C': 1, 'BEC358D': 1,
        'BME301': 4, 'BME302': 4, 'BME303': 4, 'BME304': 3, 'BMEL305': 1, 'BMEL306': 1,
        'BME306A': 3, 'BME306B': 3, 'BME306C': 3, 'BME306D': 3,
        'BME358A': 1, 'BME358B': 1, 'BME358C': 1, 'BME358D': 1,
        'BEE301': 4, 'BEE302': 4, 'BEE303': 4, 'BEE304': 3, 'BEEL305': 1, 'BEEL306': 1,
        'BEE306A': 3, 'BEE306B': 3, 'BEE306C': 3, 'BEE306D': 3,
        'BEE358A': 1, 'BEE358B': 1, 'BEE358C': 1, 'BEE358D': 1,
        'BET301': 4, 'BET302': 4, 'BET303': 4, 'BET304': 3, 'BETL305': 1, 'BETL306': 1,
        'BET306A': 3, 'BET306B': 3, 'BET306C': 3, 'BET306D': 3,
        'BET358A': 1, 'BET358B': 1, 'BET358C': 1, 'BET358D': 1,
        'BAE301': 4, 'BAE302': 4, 'BAE303': 4, 'BAE304': 3, 'BAEL305': 1, 'BAEL306': 1,
        'BAE306A': 3, 'BAE306B': 3, 'BAE306C': 3, 'BAE306D': 3,
        'BAE358A': 1, 'BAE358B': 1, 'BAE358C': 1, 'BAE358D': 1,
        'BBT301': 4, 'BBT302': 4, 'BBT303': 4, 'BBT304': 3, 'BBTL305': 1, 'BBTL306': 1,
        'BBT306A': 3, 'BBT306B': 3, 'BBT306C': 3, 'BBT306D': 3,
        'BBT358A': 1, 'BBT358B': 1, 'BBT358C': 1, 'BBT358D': 1,
        'BCH301': 4, 'BCH302': 4, 'BCH303': 4, 'BCH304': 3, 'BCHL305': 1, 'BCHL306': 1,
        'BCH306A': 3, 'BCH306B': 3, 'BCH306C': 3, 'BCH306D': 3,
        'BCH358A': 1, 'BCH358B': 1, 'BCH358C': 1, 'BCH358D': 1,
        'BIM301': 4, 'BIM302': 4, 'BIM303': 4, 'BIM304': 3, 'BIML305': 1, 'BIML306': 1,
        'BIM306A': 3, 'BIM306B': 3, 'BIM306C': 3, 'BIM306D': 3,
        'BIM358A': 1, 'BIM358B': 1, 'BIM358C': 1, 'BIM358D': 1,
        'BCC301': 4, 'BCC302': 4, 'BCC303': 4, 'BCC304': 3, 'BCCL305': 1, 'BCCL306': 1,
        'BCC306A': 3, 'BCC306B': 3, 'BCC306C': 3, 'BCC306D': 3,
        'BCC358A': 1, 'BCC358B': 1, 'BCC358C': 1, 'BCC358D': 1,
        'BCT301': 4, 'BCT302': 4, 'BCT303': 4, 'BCT304': 3, 'BCTL305': 1, 'BCTL306': 1,
        'BCT306A': 3, 'BCT306B': 3, 'BCT306C': 3, 'BCT306D': 3,
        'BCT358A': 1, 'BCT358B': 1, 'BCT358C': 1, 'BCT358D': 1,
        'BAU301': 4, 'BAU302': 4, 'BAU303': 4, 'BAU304': 3, 'BAUL305': 1, 'BAUL306': 1,
        'BAU306A': 3, 'BAU306B': 3, 'BAU306C': 3, 'BAU306D': 3,
        'BAU358A': 1, 'BAU358B': 1, 'BAU358C': 1, 'BAU358D': 1,
        'BBM301': 4, 'BBM302': 4, 'BBM303': 4, 'BBM304': 3, 'BBML305': 1, 'BBML306': 1,
        'BBM306A': 3, 'BBM306B': 3, 'BBM306C': 3, 'BBM306D': 3,
        'BBM358A': 1, 'BBM358B': 1, 'BBM358C': 1, 'BBM358D': 1,
        'BEV301': 4, 'BEV302': 4, 'BEV303': 4, 'BEV304': 3, 'BEVL305': 1, 'BEVL306': 1,
        'BEV306A': 3, 'BEV306B': 3, 'BEV306C': 3, 'BEV306D': 3,
        'BEV358A': 1, 'BEV358B': 1, 'BEV358C': 1, 'BEV358D': 1,
        'BIP301': 4, 'BIP302': 4, 'BIP303': 4, 'BIP304': 3, 'BIPL305': 1, 'BIPL306': 1,
        'BIP306A': 3, 'BIP306B': 3, 'BIP306C': 3, 'BIP306D': 3,
        'BIP358A': 1, 'BIP358B': 1, 'BIP358C': 1, 'BIP358D': 1,
        'BIT301': 4, 'BIT302': 4, 'BIT303': 4, 'BIT304': 3, 'BITL305': 1, 'BITL306': 1,
        'BIT306A': 3, 'BIT306B': 3, 'BIT306C': 3, 'BIT306D': 3,
        'BIT358A': 1, 'BIT358B': 1, 'BIT358C': 1, 'BIT358D': 1,
        'BMS301': 4, 'BMS302': 4, 'BMS303': 4, 'BMS304': 3, 'BMSL305': 1, 'BMSL306': 1,
        'BMS306A': 3, 'BMS306B': 3, 'BMS306C': 3, 'BMS306D': 3,
        'BMS358A': 1, 'BMS358B': 1, 'BMS358C': 1, 'BMS358D': 1,
        'BMR301': 4, 'BMR302': 4, 'BMR303': 4, 'BMR304': 3, 'BMRL305': 1, 'BMRL306': 1,
        'BMR306A': 3, 'BMR306B': 3, 'BMR306C': 3, 'BMR306D': 3,
        'BMR358A': 1, 'BMR358B': 1, 'BMR358C': 1, 'BMR358D': 1,
        'BMT301': 4, 'BMT302': 4, 'BMT303': 4, 'BMT304': 3, 'BMTL305': 1, 'BMTL306': 1,
        'BMT306A': 3, 'BMT306B': 3, 'BMT306C': 3, 'BMT306D': 3,
        'BMT358A': 1, 'BMT358B': 1, 'BMT358C': 1, 'BMT358D': 1,
        'BML301': 4, 'BML302': 4, 'BML303': 4, 'BML304': 3, 'BMLL305': 1, 'BMLL306': 1,
        'BML306A': 3, 'BML306B': 3, 'BML306C': 3, 'BML306D': 3,
        'BML358A': 1, 'BML358B': 1, 'BML358C': 1, 'BML358D': 1,
        'BMN301': 4, 'BMN302': 4, 'BMN303': 4, 'BMN304': 3, 'BMNL305': 1, 'BMNL306': 1,
        'BMN306A': 3, 'BMN306B': 3, 'BMN306C': 3, 'BMN306D': 3,
        'BMN358A': 1, 'BMN358B': 1, 'BMN358C': 1, 'BMN358D': 1,
        'BNT301': 4, 'BNT302': 4, 'BNT303': 4, 'BNT304': 3, 'BNTL305': 1, 'BNTL306': 1,
        'BNT306A': 3, 'BNT306B': 3, 'BNT306C': 3, 'BNT306D': 3,
        'BNT358A': 1, 'BNT358B': 1, 'BNT358C': 1, 'BNT358D': 1,
        'BPC301': 4, 'BPC302': 4, 'BPC303': 4, 'BPC304': 3, 'BPCL305': 1, 'BPCL306': 1,
        'BPC306A': 3, 'BPC306B': 3, 'BPC306C': 3, 'BPC306D': 3,
        'BPC358A': 1, 'BPC358B': 1, 'BPC358C': 1, 'BPC358D': 1,
        'BST301': 4, 'BST302': 4, 'BST303': 4, 'BST304': 3, 'BSTL305': 1, 'BSTL306': 1,
        'BST306A': 3, 'BST306B': 3, 'BST306C': 3, 'BST306D': 3,
        'BST358A': 1, 'BST358B': 1, 'BST358C': 1, 'BST358D': 1,
        'BTX301': 4, 'BTX302': 4, 'BTX303': 4, 'BTX304': 3, 'BTXL305': 1, 'BTXL306': 1,
        'BTX306A': 3, 'BTX306B': 3, 'BTX306C': 3, 'BTX306D': 3,
        'BTX358A': 1, 'BTX358B': 1, 'BTX358C': 1, 'BTX358D': 1,
        'BSCK307': 1, 'BNSK359': 0, 'BPEK359': 0, 'BYOK359': 0, 'BMATDIP301': 0,

        // Semester IV
        'BCV401': 4, 'BCV402': 4, 'BCV403': 4, 'BCV404': 3, 'BCVL405': 1, 'BCVL406': 1,
        'BCV405A': 3, 'BCV405B': 3, 'BCV405C': 3, 'BCV405D': 3,
        'BCV456A': 1, 'BCV456B': 1, 'BCV456C': 1, 'BCV456D': 1,
        'BCS401': 3, 'BCS402': 4, 'BCS403': 4, 'BCS404': 3, 'BCSL405': 1, 'BCSL406': 1,
        'BCS405A': 3, 'BCS405B': 3, 'BCS405C': 3, 'BCS405D': 3,
        'BCS456A': 1, 'BCS456B': 1, 'BCS456C': 1, 'BCS456D': 1,
        'BAI401': 4, 'BAI402': 4, 'BAI403': 4, 'BAI404': 3, 'BAIL405': 1, 'BAIL406': 1,
        'BAI405A': 3, 'BAI405B': 3, 'BAI405C': 3, 'BAI405D': 3,
        'BAI456A': 1, 'BAI456B': 1, 'BAI456C': 1, 'BAI456D': 1,
        'BDS456A': 1, 'BDS456B': 1, 'BDS456C': 1, 'BDS456D': 1,
        'BDSL456A': 1, 'BDSL456B': 1, 'BDSL456C': 1, 'BDSL456D': 1,
        'BAD456A': 1, 'BAD456B': 1, 'BAD456C': 1, 'BAD456D': 1,
        'BIS401': 4, 'BIS402': 4, 'BIS403': 4, 'BIS404': 3, 'BISL405': 1, 'BISL406': 1,
        'BIS405A': 3, 'BIS405B': 3, 'BIS405C': 3, 'BIS405D': 3,
        'BIS456A': 1, 'BIS456B': 1, 'BIS456C': 1, 'BIS456D': 1,
        'BEC401': 4, 'BEC402': 4, 'BEC403': 4, 'BEC404': 3, 'BECL405': 1, 'BECL406': 1,
        'BEC405A': 3, 'BEC405B': 3, 'BEC405C': 3, 'BEC405D': 3,
        'BEC456A': 1, 'BEC456B': 1, 'BEC456C': 1, 'BEC456D': 1,
        'BME401': 4, 'BME402': 4, 'BME403': 4, 'BME404': 3, 'BMEL405': 1, 'BMEL406': 1,
        'BME405A': 3, 'BME405B': 3, 'BME405C': 3, 'BME405D': 3,
        'BME456A': 1, 'BME456B': 1, 'BME456C': 1, 'BME456D': 1,
        'BEE401': 4, 'BEE402': 4, 'BEE403': 4, 'BEE404': 3, 'BEEL405': 1, 'BEEL406': 1,
        'BEE405A': 3, 'BEE405B': 3, 'BEE405C': 3, 'BEE405D': 3,
        'BEE456A': 1, 'BEE456B': 1, 'BEE456C': 1, 'BEE456D': 1,
        'BET401': 4, 'BET402': 4, 'BET403': 4, 'BET404': 3, 'BETL405': 1, 'BETL406': 1,
        'BET405A': 3, 'BET405B': 3, 'BET405C': 3, 'BET405D': 3,
        'BET456A': 1, 'BET456B': 1, 'BET456C': 1, 'BET456D': 1,
        'BAE401': 4, 'BAE402': 4, 'BAE403': 4, 'BAE404': 3, 'BAEL405': 1, 'BAEL406': 1,
        'BAE405A': 3, 'BAE405B': 3, 'BAE405C': 3, 'BAE405D': 3,
        'BAE456A': 1, 'BAE456B': 1, 'BAE456C': 1, 'BAE456D': 1,
        'BBT401': 4, 'BBT402': 4, 'BBT403': 4, 'BBT404': 3, 'BBTL405': 1, 'BBTL406': 1,
        'BBT405A': 3, 'BBT405B': 3, 'BBT405C': 3, 'BBT405D': 3,
        'BBT456A': 1, 'BBT456B': 1, 'BBT456C': 1, 'BBT456D': 1,
        'BCH401': 4, 'BCH402': 4, 'BCH403': 4, 'BCH404': 3, 'BCHL405': 1, 'BCHL406': 1,
        'BCH405A': 3, 'BCH405B': 3, 'BCH405C': 3, 'BCH405D': 3,
        'BCH456A': 1, 'BCH456B': 1, 'BCH456C': 1, 'BCH456D': 1,
        'BIM401': 4, 'BIM402': 4, 'BIM403': 4, 'BIM404': 3, 'BIML405': 1, 'BIML406': 1,
        'BIM405A': 3, 'BIM405B': 3, 'BIM405C': 3, 'BIM405D': 3,
        'BIM456A': 1, 'BIM456B': 1, 'BIM456C': 1, 'BIM456D': 1,
        'BCC401': 4, 'BCC402': 4, 'BCC403': 4, 'BCC404': 3, 'BCCL405': 1, 'BCCL406': 1,
        'BCC405A': 3, 'BCC405B': 3, 'BCC405C': 3, 'BCC405D': 3,
        'BCC456A': 1, 'BCC456B': 1, 'BCC456C': 1, 'BCC456D': 1,
        'BCT401': 4, 'BCT402': 4, 'BCT403': 4, 'BCT404': 3, 'BCTL405': 1, 'BCTL406': 1,
        'BCT405A': 3, 'BCT405B': 3, 'BCT405C': 3, 'BCT405D': 3,
        'BCT456A': 1, 'BCT456B': 1, 'BCT456C': 1, 'BCT456D': 1,
        'BAU401': 4, 'BAU402': 4, 'BAU403': 4, 'BAU404': 3, 'BAUL405': 1, 'BAUL406': 1,
        'BAU405A': 3, 'BAU405B': 3, 'BAU405C': 3, 'BAU405D': 3,
        'BAU456A': 1, 'BAU456B': 1, 'BAU456C': 1, 'BAU456D': 1,
        'BBM401': 4, 'BBM402': 4, 'BBM403': 4, 'BBM404': 3, 'BBML405': 1, 'BBML406': 1,
        'BBM405A': 3, 'BBM405B': 3, 'BBM405C': 3, 'BBM405D': 3,
        'BBM456A': 1, 'BBM456B': 1, 'BBM456C': 1, 'BBM456D': 1,
        'BEV401': 4, 'BEV402': 4, 'BEV403': 4, 'BEV404': 3, 'BEVL405': 1, 'BEVL406': 1,
        'BEV405A': 3, 'BEV405B': 3, 'BEV405C': 3, 'BEV405D': 3,
        'BEV456A': 1, 'BEV456B': 1, 'BEV456C': 1, 'BEV456D': 1,
        'BIP401': 4, 'BIP402': 4, 'BIP403': 4, 'BIP404': 3, 'BIPL405': 1, 'BIPL406': 1,
        'BIP405A': 3, 'BIP405B': 3, 'BIP405C': 3, 'BIP405D': 3,
        'BIP456A': 1, 'BIP456B': 1, 'BIP456C': 1, 'BIP456D': 1,
        'BIT401': 4, 'BIT402': 4, 'BIT403': 4, 'BIT404': 3, 'BITL405': 1, 'BITL406': 1,
        'BIT405A': 3, 'BIT405B': 3, 'BIT405C': 3, 'BIT405D': 3,
        'BIT456A': 1, 'BIT456B': 1, 'BIT456C': 1, 'BIT456D': 1,
        'BMS401': 4, 'BMS402': 4, 'BMS403': 4, 'BMS404': 3, 'BMSL405': 1, 'BMSL406': 1,
        'BMS405A': 3, 'BMS405B': 3, 'BMS405C': 3, 'BMS405D': 3,
        'BMS456A': 1, 'BMS456B': 1, 'BMS456C': 1, 'BMS456D': 1,
        'BMR401': 4, 'BMR402': 4, 'BMR403': 4, 'BMR404': 3, 'BMRL405': 1, 'BMRL406': 1,
        'BMR405A': 3, 'BMR405B': 3, 'BMR405C': 3, 'BMR405D': 3,
        'BMR456A': 1, 'BMR456B': 1, 'BMR456C': 1, 'BMR456D': 1,
        'BMT401': 4, 'BMT402': 4, 'BMT403': 4, 'BMT404': 3, 'BMTL405': 1, 'BMTL406': 1,
        'BMT405A': 3, 'BMT405B': 3, 'BMT405C': 3, 'BMT405D': 3,
        'BMT456A': 1, 'BMT456B': 1, 'BMT456C': 1, 'BMT456D': 1,
        'BML401': 4, 'BML402': 4, 'BML403': 4, 'BML404': 3, 'BMLL405': 1, 'BMLL406': 1,
        'BML405A': 3, 'BML405B': 3, 'BML405C': 3, 'BML405D': 3,
        'BML456A': 1, 'BML456B': 1, 'BML456C': 1, 'BML456D': 1,
        'BMN401': 4, 'BMN402': 4, 'BMN403': 4, 'BMN404': 3, 'BMNL405': 1, 'BMNL406': 1,
        'BMN405A': 3, 'BMN405B': 3, 'BMN405C': 3, 'BMN405D': 3,
        'BMN456A': 1, 'BMN456B': 1, 'BMN456C': 1, 'BMN456D': 1,
        'BNT401': 4, 'BNT402': 4, 'BNT403': 4, 'BNT404': 3, 'BNTL405': 1, 'BNTL406': 1,
        'BNT405A': 3, 'BNT405B': 3, 'BNT405C': 3, 'BNT405D': 3,
        'BNT456A': 1, 'BNT456B': 1, 'BNT456C': 1, 'BNT456D': 1,
        'BPC401': 4, 'BPC402': 4, 'BPC403': 4, 'BPC404': 3, 'BPCL405': 1, 'BPCL406': 1,
        'BPC405A': 3, 'BPC405B': 3, 'BPC405C': 3, 'BPC405D': 3,
        'BPC456A': 1, 'BPC456B': 1, 'BPC456C': 1, 'BPC456D': 1,
        'BST401': 4, 'BST402': 4, 'BST403': 4, 'BST404': 3, 'BSTL405': 1, 'BSTL406': 1,
        'BST405A': 3, 'BST405B': 3, 'BST405C': 3, 'BST405D': 3,
        'BST456A': 1, 'BST456B': 1, 'BST456C': 1, 'BST456D': 1,
        'BTX401': 4, 'BTX402': 4, 'BTX403': 4, 'BTX404': 3, 'BTXL405': 1, 'BTXL406': 1,
        'BTX405A': 3, 'BTX405B': 3, 'BTX405C': 3, 'BTX405D': 3,
        'BTX456A': 1, 'BTX456B': 1, 'BTX456C': 1, 'BTX456D': 1,
        'BCIV407': 1, 'BUHK408': 1, 'BBOC407': 3, 'BINT409': 2, 'BMATDIP401': 0,
        'BNSK459': 0, 'BPEK459': 0, 'BYOK459': 0,

        // Semester V
        'BCV501': 3, 'BCV502': 4, 'BCV503': 3, 'BCV504': 3, 'BCVL505': 1,
        'BCV508': 1, 'BCV515A': 3, 'BCV515B': 3, 'BCV515C': 3, 'BCV515D': 3, 'BCV586': 2,
        'BCS501': 3, 'BCS502': 4, 'BCS503': 3, 'BCS504': 3, 'BCSL505': 1,
        'BCS508': 1, 'BCS515A': 3, 'BCS515B': 3, 'BCS515C': 3, 'BCS515D': 3, 'BCS586': 2,
        'BAI501': 3, 'BAI502': 4, 'BAI503': 3, 'BAI504': 3, 'BAIL505': 1,
        'BAI508': 1, 'BAI515A': 3, 'BAI515B': 3, 'BAI515C': 3, 'BAI515D': 3, 'BCI586': 2,
        'BIS501': 3, 'BIS502': 4, 'BIS503': 3, 'BIS504': 3, 'BISL505': 1,
        'BIS508': 1, 'BIS515A': 3, 'BIS515B': 3, 'BIS515C': 3, 'BIS515D': 3, 'BIS586': 2,
        'BEC501': 3, 'BEC502': 4, 'BEC503': 3, 'BEC504': 3, 'BECL505': 1,
        'BEC508': 1, 'BEC515A': 3, 'BEC515B': 3, 'BEC515C': 3, 'BEC515D': 3, 'BEC586': 2,
        'BME501': 3, 'BME502': 4, 'BME503': 3, 'BME504': 3, 'BMEL505': 1,
        'BME508': 1, 'BME515A': 3, 'BME515B': 3, 'BME515C': 3, 'BME515D': 3, 'BME586': 2,
        'BEE501': 3, 'BEE502': 4, 'BEE503': 3, 'BEE504': 3, 'BEEL505': 1,
        'BEE508': 1, 'BEE515A': 3, 'BEE515B': 3, 'BEE515C': 3, 'BEE515D': 3, 'BEE586': 2,
        'BET501': 3, 'BET502': 4, 'BET503': 3, 'BET504': 3, 'BETL505': 1,
        'BET508': 1, 'BET515A': 3, 'BET515B': 3, 'BET515C': 3, 'BET515D': 3, 'BET586': 2,
        'BAE501': 3, 'BAE502': 4, 'BAE503': 3, 'BAE504': 3, 'BAEL505': 1,
        'BAE508': 1, 'BAE515A': 3, 'BAE515B': 3, 'BAE515C': 3, 'BAE515D': 3, 'BAE586': 2,
        'BBT501': 3, 'BBT502': 4, 'BBT503': 3, 'BBT504': 3, 'BBTL505': 1,
        'BBT508': 1, 'BBT515A': 3, 'BBT515B': 3, 'BBT515C': 3, 'BBT515D': 3, 'BBT586': 2,
        'BCH501': 3, 'BCH502': 4, 'BCH503': 3, 'BCH504': 3, 'BCHL505': 1,
        'BCH508': 1, 'BCH515A': 3, 'BCH515B': 3, 'BCH515C': 3, 'BCH515D': 3, 'BCH586': 2,
        'BIM501': 3, 'BIM502': 4, 'BIM503': 3, 'BIM504': 3, 'BIML505': 1,
        'BIM508': 1, 'BIM515A': 3, 'BIM515B': 3, 'BIM515C': 3, 'BIM515D': 3, 'BIM586': 2,
        'BCC501': 3, 'BCC502': 4, 'BCC503': 3, 'BCC504': 3, 'BCCL505': 1,
        'BCC508': 1, 'BCC515A': 3, 'BCC515B': 3, 'BCC515C': 3, 'BCC515D': 3, 'BCC586': 2,
        'BCT501': 3, 'BCT502': 4, 'BCT503': 3, 'BCT504': 3, 'BCTL505': 1,
        'BCT508': 1, 'BCT515A': 3, 'BCT515B': 3, 'BCT515C': 3, 'BCT515D': 3, 'BCT586': 2,
        'BAU501': 3, 'BAU502': 4, 'BAU503': 3, 'BAU504': 3, 'BAUL505': 1,
        'BAU508': 1, 'BAU515A': 3, 'BAU515B': 3, 'BAU515C': 3, 'BAU515D': 3, 'BAU586': 2,
        'BBM501': 3, 'BBM502': 4, 'BBM503': 3, 'BBM504': 3, 'BBML505': 1,
        'BBM508': 1, 'BBM515A': 3, 'BBM515B': 3, 'BBM515C': 3, 'BBM515D': 3, 'BBM586': 2,
        'BEV501': 3, 'BEV502': 4, 'BEV503': 3, 'BEV504': 3, 'BEVL505': 1,
        'BEV508': 1, 'BEV515A': 3, 'BEV515B': 3, 'BEV515C': 3, 'BEV515D': 3, 'BEV586': 2,
        'BIP501': 3, 'BIP502': 4, 'BIP503': 3, 'BIP504': 3, 'BIPL505': 1,
        'BIP508': 1, 'BIP515A': 3, 'BIP515B': 3, 'BIP515C': 3, 'BIP515D': 3, 'BIP586': 2,
        'BIT501': 3, 'BIT502': 4, 'BIT503': 3, 'BIT504': 3, 'BITL505': 1,
        'BIT508': 1, 'BIT515A': 3, 'BIT515B': 3, 'BIT515C': 3, 'BIT515D': 3, 'BIT586': 2,
        'BMS501': 3, 'BMS502': 4, 'BMS503': 3, 'BMS504': 3, 'BMSL505': 1,
        'BMS508': 1, 'BMS515A': 3, 'BMS515B': 3, 'BMS515C': 3, 'BMS515D': 3, 'BMS586': 2,
        'BMR501': 3, 'BMR502': 4, 'BMR503': 3, 'BMR504': 3, 'BMRL505': 1,
        'BMR508': 1, 'BMR515A': 3, 'BMR515B': 3, 'BMR515C': 3, 'BMR515D': 3, 'BMR586': 2,
        'BMT501': 3, 'BMT502': 4, 'BMT503': 3, 'BMT504': 3, 'BMTL505': 1,
        'BMT508': 1, 'BMT515A': 3, 'BMT515B': 3, 'BMT515C': 3, 'BMT515D': 3, 'BMT586': 2,
        'BML501': 3, 'BML502': 4, 'BML503': 3, 'BML504': 3, 'BMLL505': 1,
        'BML508': 1, 'BML515A': 3, 'BML515B': 3, 'BML515C': 3, 'BML515D': 3, 'BML586': 2,
        'BMN501': 3, 'BMN502': 4, 'BMN503': 3, 'BMN504': 3, 'BMNL505': 1,
        'BMN508': 1, 'BMN515A': 3, 'BMN515B': 3, 'BMN515C': 3, 'BMN515D': 3, 'BMN586': 2,
        'BNT501': 3, 'BNT502': 4, 'BNT503': 3, 'BNT504': 3, 'BNTL505': 1,
        'BNT508': 1, 'BNT515A': 3, 'BNT515B': 3, 'BNT515C': 3, 'BNT515D': 3, 'BNT586': 2,
        'BPC501': 3, 'BPC502': 4, 'BPC503': 3, 'BPC504': 3, 'BPCL505': 1,
        'BPC508': 1, 'BPC515A': 3, 'BPC515B': 3, 'BPC515C': 3, 'BPC515D': 3, 'BPC586': 2,
        'BST501': 3, 'BST502': 4, 'BST503': 3, 'BST504': 3, 'BSTL505': 1,
        'BST508': 1, 'BST515A': 3, 'BST515B': 3, 'BST515C': 3, 'BST515D': 3, 'BST586': 2,
        'BTX501': 3, 'BTX502': 4, 'BTX503': 3, 'BTX504': 3, 'BTXL505': 1,
        'BTX508': 1, 'BTX515A': 3, 'BTX515B': 3, 'BTX515C': 3, 'BTX515D': 3, 'BTX586': 2,
        'BRMK557': 3, 'BNSK559': 0, 'BPEK559': 0, 'BYOK559': 0,

        // Semester VI
        'BCV601': 4, 'BCV602': 4, 'BCV613A': 3, 'BCV613B': 3, 'BCV613C': 3, 'BCV613D': 3,
        'BCV654A': 3, 'BCV654B': 3, 'BCV654C': 3, 'BCV654D': 3, 'BCV685': 2, 'BCVL606': 1,
        'BCV657A': 1, 'BCV657B': 1, 'BCV657C': 1, 'BCV657D': 1,
        'BCS601': 4, 'BCO601': 4, 'BCS602': 4, 'BCS613A': 3, 'BCS613B': 3, 'BCS613C': 3, 'BCS613D': 3,
        'BCS654A': 3, 'BCS654B': 3, 'BCS654C': 3, 'BCS654D': 3, 'BCS685': 2, 'BCSL606': 1,
        'BCS657A': 1, 'BCS657B': 1, 'BCS657C': 1, 'BCS657D': 1,
        'BCI601': 4, 'BCO601': 4, 'BCI602': 4, 'BCI613A': 3, 'BCI613B': 3, 'BCI613C': 3, 'BCI613D': 3,
        'BCI654A': 3, 'BCI654B': 3, 'BCI654C': 3, 'BCI654D': 3, 'BCI685': 2, 'BCIL606': 1,
        'BCI657A': 1, 'BCI657B': 1, 'BCI657C': 1, 'BCI657D': 1,
        'BIS601': 4, 'BIS602': 4, 'BIS613A': 3, 'BIS613B': 3, 'BIS613C': 3, 'BIS613D': 3,
        'BIS654A': 3, 'BIS654B': 3, 'BIS654C': 3, 'BIS654D': 3, 'BIS685': 2, 'BISL606': 1,
        'BIS657A': 1, 'BIS657B': 1, 'BIS657C': 1, 'BIS657D': 1,
        'BEC601': 4, 'BEC602': 4, 'BEC613A': 3, 'BEC613B': 3, 'BEC613C': 3, 'BEC613D': 3,
        'BEC654A': 3, 'BEC654B': 3, 'BEC654C': 3, 'BEC654D': 3, 'BEC685': 2, 'BECL606': 1,
        'BEC657A': 1, 'BEC657B': 1, 'BEC657C': 1, 'BEC657D': 1,
        'BME601': 4, 'BME602': 4, 'BME613A': 3, 'BME613B': 3, 'BME613C': 3, 'BME613D': 3,
        'BME654A': 3, 'BME654B': 3, 'BME654C': 3, 'BME654D': 3, 'BME685': 2, 'BMEL606': 1,
        'BME657A': 1, 'BME657B': 1, 'BME657C': 1, 'BME657D': 1,
        'BEE601': 4, 'BEE602': 4, 'BEE613A': 3, 'BEE613B': 3, 'BEE613C': 3, 'BEE613D': 3,
        'BEE654A': 3, 'BEE654B': 3, 'BEE654C': 3, 'BEE654D': 3, 'BEE685': 2, 'BEEL606': 1,
        'BEE657A': 1, 'BEE657B': 1, 'BEE657C': 1, 'BEE657D': 1,
        'BET601': 4, 'BET602': 4, 'BET613A': 3, 'BET613B': 3, 'BET613C': 3, 'BET613D': 3,
        'BET654A': 3, 'BET654B': 3, 'BET654C': 3, 'BET654D': 3, 'BET685': 2, 'BETL606': 1,
        'BET657A': 1, 'BET657B': 1, 'BET657C': 1, 'BET657D': 1,
        'BAE601': 4, 'BAE602': 4, 'BAE613A': 3, 'BAE613B': 3, 'BAE613C': 3, 'BAE613D': 3,
        'BAE654A': 3, 'BAE654B': 3, 'BAE654C': 3, 'BAE654D': 3, 'BAE685': 2, 'BAEL606': 1,
        'BAE657A': 1, 'BAE657B': 1, 'BAE657C': 1, 'BAE657D': 1,
        'BBT601': 4, 'BBT602': 4, 'BBT613A': 3, 'BBT613B': 3, 'BBT613C': 3, 'BBT613D': 3,
        'BBT654A': 3, 'BBT654B': 3, 'BBT654C': 3, 'BBT654D': 3, 'BBT685': 2, 'BBTL606': 1,
        'BBT657A': 1, 'BBT657B': 1, 'BBT657C': 1, 'BBT657D': 1,
        'BCH601': 4, 'BCH602': 4, 'BCH613A': 3, 'BCH613B': 3, 'BCH613C': 3, 'BCH613D': 3,
        'BCH654A': 3, 'BCH654B': 3, 'BCH654C': 3, 'BCH654D': 3, 'BCH685': 2, 'BCHL606': 1,
        'BCH657A': 1, 'BCH657B': 1, 'BCH657C': 1, 'BCH657D': 1,
        'BIM601': 4, 'BIM602': 4, 'BIM613A': 3, 'BIM613B': 3, 'BIM613C': 3, 'BIM613D': 3,
        'BIM654A': 3, 'BIM654B': 3, 'BIM654C': 3, 'BIM654D': 3, 'BIM685': 2, 'BIML606': 1,
        'BIM657A': 1, 'BIM657B': 1, 'BIM657C': 1, 'BIM657D': 1,
        'BCC601': 4, 'BCC602': 4, 'BCC613A': 3, 'BCC613B': 3, 'BCC613C': 3, 'BCC613D': 3,
        'BCC654A': 3, 'BCC654B': 3, 'BCC654C': 3, 'BCC654D': 3, 'BCC685': 2, 'BCCL606': 1,
        'BCC657A': 1, 'BCC657B': 1, 'BCC657C': 1, 'BCC657D': 1,
        'BCT601': 4, 'BCT602': 4, 'BCT613A': 3, 'BCT613B': 3, 'BCT613C': 3, 'BCT613D': 3,
        'BCT654A': 3, 'BCT654B': 3, 'BCT654C': 3, 'BCT654D': 3, 'BCT685': 2, 'BCTL606': 1,
        'BCT657A': 1, 'BCT657B': 1, 'BCT657C': 1, 'BCT657D': 1,
        'BAU601': 4, 'BAU602': 4, 'BAU613A': 3, 'BAU613B': 3, 'BAU613C': 3, 'BAU613D': 3,
        'BAU654A': 3, 'BAU654B': 3, 'BAU654C': 3, 'BAU654D': 3, 'BAU685': 2, 'BAUL606': 1,
        'BAU657A': 1, 'BAU657B': 1, 'BAU657C': 1, 'BAU657D': 1,
        'BBM601': 4, 'BBM602': 4, 'BBM613A': 3, 'BBM613B': 3, 'BBM613C': 3, 'BBM613D': 3,
        'BBM654A': 3, 'BBM654B': 3, 'BBM654C': 3, 'BBM654D': 3, 'BBM685': 2, 'BBML606': 1,
        'BBM657A': 1, 'BBM657B': 1, 'BBM657C': 1, 'BBM657D': 1,
        'BEV601': 4, 'BEV602': 4, 'BEV613A': 3, 'BEV613B': 3, 'BEV613C': 3, 'BEV613D': 3,
        'BEV654A': 3, 'BEV654B': 3, 'BEV654C': 3, 'BEV654D': 3, 'BEV685': 2, 'BEVL606': 1,
        'BEV657A': 1, 'BEV657B': 1, 'BEV657C': 1, 'BEV657D': 1,
        'BIP601': 4, 'BIP602': 4, 'BIP613A': 3, 'BIP613B': 3, 'BIP613C': 3, 'BIP613D': 3,
        'BIP654A': 3, 'BIP654B': 3, 'BIP654C': 3, 'BIP654D': 3, 'BIP685': 2, 'BIPL606': 1,
        'BIP657A': 1, 'BIP657B': 1, 'BIP657C': 1, 'BIP657D': 1,
        'BIT601': 4, 'BIT602': 4, 'BIT613A': 3, 'BIT613B': 3, 'BIT613C': 3, 'BIT613D': 3,
        'BIT654A': 3, 'BIT654B': 3, 'BIT654C': 3, 'BIT654D': 3, 'BIT685': 2, 'BITL606': 1,
        'BIT657A': 1, 'BIT657B': 1, 'BIT657C': 1, 'BIT657D': 1,
        'BMS601': 4, 'BMS602': 4, 'BMS613A': 3, 'BMS613B': 3, 'BMS613C': 3, 'BMS613D': 3,
        'BMS654A': 3, 'BMS654B': 3, 'BMS654C': 3, 'BMS654D': 3, 'BMS685': 2, 'BMSL606': 1,
        'BMS657A': 1, 'BMS657B': 1, 'BMS657C': 1, 'BMS657D': 1,
        'BMR601': 4, 'BMR602': 4, 'BMR613A': 3, 'BMR613B': 3, 'BMR613C': 3, 'BMR613D': 3,
        'BMR654A': 3, 'BMR654B': 3, 'BMR654C': 3, 'BMR654D': 3, 'BMR685': 2, 'BMRL606': 1,
        'BMR657A': 1, 'BMR657B': 1, 'BMR657C': 1, 'BMR657D': 1,
        'BMT601': 4, 'BMT602': 4, 'BMT613A': 3, 'BMT613B': 3, 'BMT613C': 3, 'BMT613D': 3,
        'BMT654A': 3, 'BMT654B': 3, 'BMT654C': 3, 'BMT654D': 3, 'BMT685': 2, 'BMTL606': 1,
        'BMT657A': 1, 'BMT657B': 1, 'BMT657C': 1, 'BMT657D': 1,
        'BML601': 4, 'BML602': 4, 'BML613A': 3, 'BML613B': 3, 'BML613C': 3, 'BML613D': 3,
        'BML654A': 3, 'BML654B': 3, 'BML654C': 3, 'BML654D': 3, 'BML685': 2, 'BMLL606': 1,
        'BML657A': 1, 'BML657B': 1, 'BML657C': 1, 'BML657D': 1,
        'BMN601': 4, 'BMN602': 4, 'BMN613A': 3, 'BMN613B': 3, 'BMN613C': 3, 'BMN613D': 3,
        'BMN654A': 3, 'BMN654B': 3, 'BMN654C': 3, 'BMN654D': 3, 'BMN685': 2, 'BMNL606': 1,
        'BMN657A': 1, 'BMN657B': 1, 'BMN657C': 1, 'BMN657D': 1,
        'BNT601': 4, 'BNT602': 4, 'BNT613A': 3, 'BNT613B': 3, 'BNT613C': 3, 'BNT613D': 3,
        'BNT654A': 3, 'BNT654B': 3, 'BNT654C': 3, 'BNT654D': 3, 'BNT685': 2, 'BNTL606': 1,
        'BNT657A': 1, 'BNT657B': 1, 'BNT657C': 1, 'BNT657D': 1,
        'BPC601': 4, 'BPC602': 4, 'BPC613A': 3, 'BPC613B': 3, 'BPC613C': 3, 'BPC613D': 3,
        'BPC654A': 3, 'BPC654B': 3, 'BPC654C': 3, 'BPC654D': 3, 'BPC685': 2, 'BPCL606': 1,
        'BPC657A': 1, 'BPC657B': 1, 'BPC657C': 1, 'BPC657D': 1,
        'BST601': 4, 'BST602': 4, 'BST613A': 3, 'BST613B': 3, 'BST613C': 3, 'BST613D': 3,
        'BST654A': 3, 'BST654B': 3, 'BST654C': 3, 'BST654D': 3, 'BST685': 2, 'BSTL606': 1,
        'BST657A': 1, 'BST657B': 1, 'BST657C': 1, 'BST657D': 1,
        'BTX601': 4, 'BTX602': 4, 'BTX613A': 3, 'BTX613B': 3, 'BTX613C': 3, 'BTX613D': 3,
        'BTX654A': 3, 'BTX654B': 3, 'BTX654C': 3, 'BTX654D': 3, 'BTX685': 2, 'BTXL606': 1,
        'BTX657A': 1, 'BTX657B': 1, 'BTX657C': 1, 'BTX657D': 1,
        'BNSK658': 0, 'BPEK658': 0, 'BYOK658': 0, 'BIKS609': 0,
        // Semester VII: Includes two PCCs (4 credits each), one mandatory course (3 credits), two PECs (3 credits each), and internship (9 credits) for all branches.
        'BCV701': 4, 'BCV702': 4, 'BCV703': 3, 'BCV714A': 3, 'BCV714B': 3, 'BCV714C': 3, 'BCV714D': 3,
        'BCV755A': 3, 'BCV755B': 3, 'BCV755C': 3, 'BCV755D': 3, 'BCV783': 9,
        'BCS701': 4, 'BCS702': 4, 'BCS703': 3, 'BCS714A': 3, 'BCS714B': 3, 'BCS714C': 3, 'BCS714D': 3,
        'BCS755A': 3, 'BCS755B': 3, 'BCS755C': 3, 'BCS755D': 3, 'BCS783': 9,
        'BCI701': 4, 'BCI702': 4, 'BCI703': 3, 'BCI714A': 3, 'BCI714B': 3, 'BCI714C': 3, 'BCI714D': 3,
        'BCI755A': 3, 'BCI755B': 3, 'BCI755C': 3, 'BCI755D': 3, 'BCI783': 9,
        'BIS701': 4, 'BIS702': 4, 'BIS703': 3, 'BIS714A': 3, 'BIS714B': 3, 'BIS714C': 3, 'BIS714D': 3,
        'BIS755A': 3, 'BIS755B': 3, 'BIS755C': 3, 'BIS755D': 3, 'BIS783': 9,
        'BEC701': 4, 'BEC702': 4, 'BEC703': 3, 'BEC714A': 3, 'BEC714B': 3, 'BEC714C': 3, 'BEC714D': 3,
        'BEC755A': 3, 'BEC755B': 3, 'BEC755C': 3, 'BEC755D': 3, 'BEC783': 9,
        'BME701': 4, 'BME702': 4, 'BME703': 3, 'BME714A': 3, 'BME714B': 3, 'BME714C': 3, 'BME714D': 3,
        'BME755A': 3, 'BME755B': 3, 'BME755C': 3, 'BME755D': 3, 'BME783': 9,
        'BEE701': 4, 'BEE702': 4, 'BEE703': 3, 'BEE714A': 3, 'BEE714B': 3, 'BEE714C': 3, 'BEE714D': 3,
        'BEE755A': 3, 'BEE755B': 3, 'BEE755C': 3, 'BEE755D': 3, 'BEE783': 9,
        'BET701': 4, 'BET702': 4, 'BET703': 3, 'BET714A': 3, 'BET714B': 3, 'BET714C': 3, 'BET714D': 3,
        'BET755A': 3, 'BET755B': 3, 'BET755C': 3, 'BET755D': 3, 'BET783': 9,
        'BAE701': 4, 'BAE702': 4, 'BAE703': 3, 'BAE714A': 3, 'BAE714B': 3, 'BAE714C': 3, 'BAE714D': 3,
        'BAE755A': 3, 'BAE755B': 3, 'BAE755C': 3, 'BAE755D': 3, 'BAE783': 9,
        'BBT701': 4, 'BBT702': 4, 'BBT703': 3, 'BBT714A': 3, 'BBT714B': 3, 'BBT714C': 3, 'BBT714D': 3,
        'BBT755A': 3, 'BBT755B': 3, 'BBT755C': 3, 'BBT755D': 3, 'BBT783': 9,
        'BCH701': 4, 'BCH702': 4, 'BCH703': 3, 'BCH714A': 3, 'BCH714B': 3, 'BCH714C': 3, 'BCH714D': 3,
        'BCH755A': 3, 'BCH755B': 3, 'BCH755C': 3, 'BCH755D': 3, 'BCH783': 9,
        'BIM701': 4, 'BIM702': 4, 'BIM703': 3, 'BIM714A': 3, 'BIM714B': 3, 'BIM714C': 3, 'BIM714D': 3,
        'BIM755A': 3, 'BIM755B': 3, 'BIM755C': 3, 'BIM755D': 3, 'BIM783': 9,
        'BCC701': 4, 'BCC702': 4, 'BCC703': 3, 'BCC714A': 3, 'BCC714B': 3, 'BCC714C': 3, 'BCC714D': 3,
        'BCC755A': 3, 'BCC755B': 3, 'BCC755C': 3, 'BCC755D': 3, 'BCC783': 9,
        'BCT701': 4, 'BCT702': 4, 'BCT703': 3, 'BCT714A': 3, 'BCT714B': 3, 'BCT714C': 3, 'BCT714D': 3,
        'BCT755A': 3, 'BCT755B': 3, 'BCT755C': 3, 'BCT755D': 3, 'BCT783': 9,
        'BAU701': 4, 'BAU702': 4, 'BAU703': 3, 'BAU714A': 3, 'BAU714B': 3, 'BAU714C': 3, 'BAU714D': 3,
        'BAU755A': 3, 'BAU755B': 3, 'BAU755C': 3, 'BAU755D': 3, 'BAU783': 9,
        'BBM701': 4, 'BBM702': 4, 'BBM703': 3, 'BBM714A': 3, 'BBM714B': 3, 'BBM714C': 3, 'BBM714D': 3,
        'BBM755A': 3, 'BBM755B': 3, 'BBM755C': 3, 'BBM755D': 3, 'BBM783': 9,
        'BEV701': 4, 'BEV702': 4, 'BEV703': 3, 'BEV714A': 3, 'BEV714B': 3, 'BEV714C': 3, 'BEV714D': 3,
        'BEV755A': 3, 'BEV755B': 3, 'BEV755C': 3, 'BEV755D': 3, 'BEV783': 9,
        'BIP701': 4, 'BIP702': 4, 'BIP703': 3, 'BIP714A': 3, 'BIP714B': 3, 'BIP714C': 3, 'BIP714D': 3,
        'BIP755A': 3, 'BIP755B': 3, 'BIP755C': 3, 'BIP755D': 3, 'BIP783': 9,
        'BIT701': 4, 'BIT702': 4, 'BIT703': 3, 'BIT714A': 3, 'BIT714B': 3, 'BIT714C': 3, 'BIT714D': 3,
        'BIT755A': 3, 'BIT755B': 3, 'BIT755C': 3, 'BIT755D': 3, 'BIT783': 9,
        'BMS701': 4, 'BMS702': 4, 'BMS703': 3, 'BMS714A': 3, 'BMS714B': 3, 'BMS714C': 3, 'BMS714D': 3,
        'BMS755A': 3, 'BMS755B': 3, 'BMS755C': 3, 'BMS755D': 3, 'BMS783': 9,
        'BMR701': 4, 'BMR702': 4, 'BMR703': 3, 'BMR714A': 3, 'BMR714B': 3, 'BMR714C': 3, 'BMR714D': 3,
        'BMR755A': 3, 'BMR755B': 3, 'BMR755C': 3, 'BMR755D': 3, 'BMR783': 9,
        'BMT701': 4, 'BMT702': 4, 'BMT703': 3, 'BMT714A': 3, 'BMT714B': 3, 'BMT714C': 3, 'BMT714D': 3,
        'BMT755A': 3, 'BMT755B': 3, 'BMT755C': 3, 'BMT755D': 3, 'BMT783': 9,
        'BML701': 4, 'BML702': 4, 'BML703': 3, 'BML714A': 3, 'BML714B': 3, 'BML714C': 3, 'BML714D': 3,
        'BML755A': 3, 'BML755B': 3, 'BML755C': 3, 'BML755D': 3, 'BML783': 9,
        'BMN701': 4, 'BMN702': 4, 'BMN703': 3, 'BMN714A': 3, 'BMN714B': 3, 'BMN714C': 3, 'BMN714D': 3,
        'BMN755A': 3, 'BMN755B': 3, 'BMN755C': 3, 'BMN755D': 3, 'BMN783': 9,
        'BNT701': 4, 'BNT702': 4, 'BNT703': 3, 'BNT714A': 3, 'BNT714B': 3, 'BNT714C': 3, 'BNT714D': 3,
        'BNT755A': 3, 'BNT755B': 3, 'BNT755C': 3, 'BNT755D': 3, 'BNT783': 9,
        'BPC701': 4, 'BPC702': 4, 'BPC703': 3, 'BPC714A': 3, 'BPC714B': 3, 'BPC714C': 3, 'BPC714D': 3,
        'BPC755A': 3, 'BPC755B': 3, 'BPC755C': 3, 'BPC755D': 3, 'BPC783': 9,
        'BST701': 4, 'BST702': 4, 'BST703': 3, 'BST714A': 3, 'BST714B': 3, 'BST714C': 3, 'BST714D': 3,
        'BST755A': 3, 'BST755B': 3, 'BST755C': 3, 'BST755D': 3, 'BST783': 9,
        'BTX701': 4, 'BTX702': 4, 'BTX703': 3, 'BTX714A': 3, 'BTX714B': 3, 'BTX714C': 3, 'BTX714D': 3,
        'BTX755A': 3, 'BTX755B': 3, 'BTX755C': 3, 'BTX755D': 3, 'BTX783': 9,

        // Semester VIII: Includes one PEC (3 credits), one OEC (3 credits), and major project (12 credits) for all branches.
        'BCV815A': 3, 'BCV815B': 3, 'BCV815C': 3, 'BCV815D': 3,
        'BCV856A': 3, 'BCV856B': 3, 'BCV856C': 3, 'BCV856D': 3, 'BCV804': 12,
        'BCS815A': 3, 'BCS815B': 3, 'BCS815C': 3, 'BCS815D': 3,
        'BCS856A': 3, 'BCS856B': 3, 'BCS856C': 3, 'BCS856D': 3, 'BCS804': 12,
        'BCI815A': 3, 'BCI815B': 3, 'BCI815C': 3, 'BCI815D': 3,
        'BCI856A': 3, 'BCI856B': 3, 'BCI856C': 3, 'BCI856D': 3, 'BCI804': 12,
        'BIS815A': 3, 'BIS815B': 3, 'BIS815C': 3, 'BIS815D': 3,
        'BIS856A': 3, 'BIS856B': 3, 'BIS856C': 3, 'BIS856D': 3, 'BIS804': 12,
        'BEC815A': 3, 'BEC815B': 3, 'BEC815C': 3, 'BEC815D': 3,
        'BEC856A': 3, 'BEC856B': 3, 'BEC856C': 3, 'BEC856D': 3, 'BEC804': 12,
        'BME815A': 3, 'BME815B': 3, 'BME815C': 3, 'BME815D': 3,
        'BME856A': 3, 'BME856B': 3, 'BME856C': 3, 'BME856D': 3, 'BME804': 12,
        'BEE815A': 3, 'BEE815B': 3, 'BEE815C': 3, 'BEE815D': 3,
        'BEE856A': 3, 'BEE856B': 3, 'BEE856C': 3, 'BEE856D': 3, 'BEE804': 12,
        'BET815A': 3, 'BET815B': 3, 'BET815C': 3, 'BET815D': 3,
        'BET856A': 3, 'BET856B': 3, 'BET856C': 3, 'BET856D': 3, 'BET804': 12,
        'BAE815A': 3, 'BAE815B': 3, 'BAE815C': 3, 'BAE815D': 3,
        'BAE856A': 3, 'BAE856B': 3, 'BAE856C': 3, 'BAE856D': 3, 'BAE804': 12,
        'BBT815A': 3, 'BBT815B': 3, 'BBT815C': 3, 'BBT815D': 3,
        'BBT856A': 3, 'BBT856B': 3, 'BBT856C': 3, 'BBT856D': 3, 'BBT804': 12,
        'BCH815A': 3, 'BCH815B': 3, 'BCH815C': 3, 'BCH815D': 3,
        'BCH856A': 3, 'BCH856B': 3, 'BCH856C': 3, 'BCH856D': 3, 'BCH804': 12,
        'BIM815A': 3, 'BIM815B': 3, 'BIM815C': 3, 'BIM815D': 3,
        'BIM856A': 3, 'BIM856B': 3, 'BIM856C': 3, 'BIM856D': 3, 'BIM804': 12,
        'BCC815A': 3, 'BCC815B': 3, 'BCC815C': 3, 'BCC815D': 3,
        'BCC856A': 3, 'BCC856B': 3, 'BCC856C': 3, 'BCC856D': 3, 'BCC804': 12,
        'BCT815A': 3, 'BCT815B': 3, 'BCT815C': 3, 'BCT815D': 3,
        'BCT856A': 3, 'BCT856B': 3, 'BCT856C': 3, 'BCT856D': 3, 'BCT804': 12,
        'BAU815A': 3, 'BAU815B': 3, 'BAU815C': 3, 'BAU815D': 3,
        'BAU856A': 3, 'BAU856B': 3, 'BAU856C': 3, 'BAU856D': 3, 'BAU804': 12,
        'BBM815A': 3, 'BBM815B': 3, 'BBM815C': 3, 'BBM815D': 3,
        'BBM856A': 3, 'BBM856B': 3, 'BBM856C': 3, 'BBM856D': 3, 'BBM804': 12,
        'BEV815A': 3, 'BEV815B': 3, 'BEV815C': 3, 'BEV815D': 3,
        'BEV856A': 3, 'BEV856B': 3, 'BEV856C': 3, 'BEV856D': 3, 'BEV804': 12,
        'BIP815A': 3, 'BIP815B': 3, 'BIP815C': 3, 'BIP815D': 3,
        'BIP856A': 3, 'BIP856B': 3, 'BIP856C': 3, 'BIP856D': 3, 'BIP804': 12,
        'BIT815A': 3, 'BIT815B': 3, 'BIT815C': 3, 'BIT815D': 3,
        'BIT856A': 3, 'BIT856B': 3, 'BIT856C': 3, 'BIT856D': 3, 'BIT804': 12,
        'BMS815A': 3, 'BMS815B': 3, 'BMS815C': 3, 'BMS815D': 3,
        'BMS856A': 3, 'BMS856B': 3, 'BMS856C': 3, 'BMS856D': 3, 'BMS804': 12,
        'BMR815A': 3, 'BMR815B': 3, 'BMR815C': 3, 'BMR815D': 3,
        'BMR856A': 3, 'BMR856B': 3, 'BMR856C': 3, 'BMR856D': 3, 'BMR804': 12,
        'BMT815A': 3, 'BMT815B': 3, 'BMT815C': 3, 'BMT815D': 3,
        'BMT856A': 3, 'BMT856B': 3, 'BMT856C': 3, 'BMT856D': 3, 'BMT804': 12,
        'BML815A': 3, 'BML815B': 3, 'BML815C': 3, 'BML815D': 3,
        'BML856A': 3, 'BML856B': 3, 'BML856C': 3, 'BML856D': 3, 'BML804': 12,
        'BMN815A': 3, 'BMN815B': 3, 'BMN815C': 3, 'BMN815D': 3,
        'BMN856A': 3, 'BMN856B': 3, 'BMN856C': 3, 'BMN856D': 3, 'BMN804': 12,
        'BNT815A': 3, 'BNT815B': 3, 'BNT815C': 3, 'BNT815D': 3,
        'BNT856A': 3, 'BNT856B': 3, 'BNT856C': 3, 'BNT856D': 3, 'BNT804': 12,
        'BPC815A': 3, 'BPC815B': 3, 'BPC815C': 3, 'BPC815D': 3,
        'BPC856A': 3, 'BPC856B': 3, 'BPC856C': 3, 'BPC856D': 3, 'BPC804': 12,
        'BST815A': 3, 'BST815B': 3, 'BST815C': 3, 'BST815D': 3,
        'BST856A': 3, 'BST856B': 3, 'BST856C': 3, 'BST856D': 3, 'BST804': 12,
        'BTX815A': 3, 'BTX815B': 3, 'BTX815C': 3, 'BTX815D': 3,
        'BTX856A': 3, 'BTX856B': 3, 'BTX856C': 3, 'BTX856D': 3, 'BTX804': 12
  };
  return creditsMap[subjectCode] || 0;
}


async function calculateSgpa(excelPath, userId) {
  // Ensure the path is a string and valid
  if (typeof excelPath !== 'string') {
    throw new TypeError('The "path" argument must be of type string.');
  }
  const workbook = new ExcelJS.Workbook();
  await workbook.xlsx.readFile(excelPath);
  const sheet = workbook.worksheets[0];

  let totalPoints = 0;
  let totalCredits = 0;

  sheet.eachRow({ includeEmpty: false }, (row, rowNumber) => {
    if (rowNumber > 1) {
      const subjectCode = row.getCell(1).value;
      const subjectName = row.getCell(2).value;
      let internalMarks = row.getCell(3).value;
      let externalMarks = row.getCell(4).value;

      internalMarks = cleanData(internalMarks);
      externalMarks = cleanData(externalMarks);

      const totalMarks = internalMarks + externalMarks;
      const gradePoints = convertToGradePoints(totalMarks);
      const credits = getCreditsForSubject(subjectCode);

      totalPoints += gradePoints * credits;
      totalCredits += credits;

      saveMarksToDb(userId, subjectCode, subjectName, internalMarks, externalMarks, gradePoints, credits);
    }
  });

  const sgpa = totalCredits > 0 ? totalPoints / totalCredits : 0;
  await saveSgpaToDb(userId, sgpa.toFixed(2)); // Ensure only two decimal points

  return sgpa.toFixed(2);
}

async function saveMarksToDb(userId, subjectCode, subjectName, internalMarks, externalMarks, gradePoints, credits) {
  if (!userId) return; // Prevent saving if public
  await pool.query(
    'INSERT INTO marks (user_id, subject_code, subject_name, internal_marks, external_marks, total, sgpa, credits) VALUES ($1, $2, $3, $4, $5, $6, $7, $8)',
    [userId, subjectCode, subjectName, internalMarks, externalMarks, internalMarks + externalMarks, gradePoints, credits]
  );
}

async function calculateCgpa(userId) {
  const result = await pool.query('SELECT sgpa, credits FROM marks WHERE user_id = $1', [userId]);
  const sGpaCredits = result.rows.map(row => ({
    sgpa: row.sgpa,
    credits: row.credits,
  }));
  
  let totalSgpaPoints = 0;
  let totalCredits = 0;

  sGpaCredits.forEach(item => {
    totalSgpaPoints += item.sgpa * item.credits;
    totalCredits += item.credits;
  });

  const cgpa = totalCredits > 0 ? totalSgpaPoints / totalCredits : 0;
  return cgpa.toFixed(2); // Ensure only two decimal points
}

async function saveSgpaToDb(userId, sgpa) {
  if (!userId) return; // Skip DB update if public
  await pool.query('UPDATE users SET sgpa = $1 WHERE user_id = $2', [sgpa, userId]);
}

module.exports = {
  calculateSgpa,
  calculateCgpa,
  saveSgpaToDb,
};